<!DOCTYPE html>
<html>
    <head>
        <title>NY Tree Data Service</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    </head>

    <body>
		<div>
            <p>Choose borough </p>
				<select class="ddboro" id="ddboro">
					<option selected="selected">Select</option>
                </select>			
		
		</div>
        <div>
            <p>Choose tree type </p>
				<select class="ddtt" id="ddtt">
					<option selected="selected">Select</option>
                </select>			
        </div>
		<script type="text/javascript" >		
		var tt;
		var boro
		var ttselected;
		var boroselected;
			$(document).ready(function() {
				$.ajax({
					url: "https://data.cityofnewyork.us/resource/uvpi-gqnh.json?$select=boroname&$group=boroname&$limit=5000"
				}).then(function(data) {
					boro = data;
					for(var i=0;i<data.length;i++)
					{
                        var opt = new Option(data[i].boroname);
                        $("#ddboro").append(opt);
                    }
				});

				$("#ddboro").change(function () {
					//var selectedText = $(this).find("option:selected").text();
					//var selectedValue = $(this).val();
					boroselected = $(this).find("option:selected").text();
					//alert("Selected Text: " + selectedText + " Value: " + selectedValue);
					
					$.ajax({
						url: "https://data.cityofnewyork.us/resource/uvpi-gqnh.json?$select=spc_common&$group=spc_common&$where=boroname='" + boroselected +"'&$limit=5000"
					}).then(function(data) {
						tt = data;
						for(var i=0;i<data.length;i++)
						{
							var opt = new Option(data[i].spc_common);
							$("#ddtt").append(opt);
						}
					});
				});				


				

				$("#ddtt").change(function () {
					//var selectedText = $(this).find("option:selected").text();
					//var selectedValue = $(this).val();
					//alert("Selected Text: " + selectedText + " Value: " + selectedValue);
					ttselected = $(this).find("option:selected").text();
					if(ttselected && boroselected)
					{
						$.ajax({
							url: "https://data.cityofnewyork.us/resource/uvpi-gqnh.json?$select=health,steward&$where=spc_common='" + ttselected + "'AND boroname='" + boroselected + "'&$limit=50000"
						}).then(function(data) {
							alert(data.length);
							for(var i=0;i<data.length;i++)
							{
								document.write (data[i].health);
								document.write ("<br/>");
								document.write (data[i].steward);
								document.write ("<br/>");
							}
						   //$('.greeting-id').append(data.id);
						   //$('.greeting-content').append(data.content);
						   //alert(data[0].boroname);
						});
					
					}
				});
			});		
		

		</script>

    </body>
</html>